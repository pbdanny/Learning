dat <- shuttle
dat$use <- factor(abs(dat$use - 2))
dat <- shuttle
dat$use1 <- factor(abs(as.integer(dat$use) - 2))
View(dat)
dat$wind2 <- factor(abs(as.integer(dat$wind) - 2))
dat$use1 <- levels(c("auto","noauto"))
View(dat)
dat <- shuttle
dat$use1 <- factor(abs(as.integer(dat$use) - 2))
dat$use1 <- levels(c("auto","noauto"))
dat <- shuttle
dat$use1 <- factor(abs(as.integer(dat$use) - 2) , levels = c("auto","noauto"))
dat <- shuttle
dat$use1 <- factor(abs(as.integer(dat$use) - 2))
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
View(dat)
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$wind1 <- abs(as.integer(dat$wind) - 2)
table(dat$wind, dat$wind1)
table(dat$use, dat$use1)
fit <- glm(dat$use1 ~ dat$wind1, family = "binomial")
summary(fit)
fit <- glm(dat$use ~ dat$wind, family = "binomial")
fit1 <- glm(dat$use1 ~ dat$wind1, family = "binomial")
summary(fit, fit1)
fit <- glm(dat$use ~ dat$wind, family = "binomial")
fit1 <- glm(dat$use1 ~ dat$wind1, family = "binomial")
fit$coefficients ; fit1$coefficients
exp(fit1$coefficients[1]+fit1$coefficients[2])
exp(fit$coefficients[1]+fit$coefficients[2])
exp(fit1$coefficients[1]+fit1$coefficients[2])
fit <- glm(dat$use ~ dat$wind, family = "binomial")
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$wind1 <- abs(as.integer(dat$wind) - 2)
table(dat$use, dat$use1)
table(dat$wind, dat$wind1)
fit <- glm(dat$use ~ dat$wind, family = "binomial")
fit1 <- glm(dat$use1 ~ dat$wind, family = "binomial")
fit$coefficients ; fit1$coefficients
exp(fit$coefficients[1]+fit$coefficients[2])
exp(fit1$coefficients[1]+fit1$coefficients[2])
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
table(dat$use, dat$use1)
fit <- glm(dat$use ~ dat$wind, family = "binomial")
fit1 <- glm(dat$use1 ~ dat$wind, family = "binomial")
fit$coefficients ; fit1$coefficients
exp(fit$coefficients[1]+fit$coefficients[2])
exp(fit1$coefficients[1]+fit1$coefficients[2])
fit2 <- update(fit1, glm(dat$use1 ~ dat$magn, family = "binomial"))
fit3 <- glm(data$use1 ~ dat$wind + dat$magn, family = "binomial")
View(dat)
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$use1 <- factor(dat$us1, levels = c("noauto","auto"))
dat <- shuttle
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$use1 <- factor(dat$us1, labels = c("noauto","auto"))
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$use1 <- factor(dat$us1, lavels = c("noauto","auto"))
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$use1 <- factor(dat$us1, levels = c("noauto","auto"))
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$use1 <- factor(dat$us1, levels = c(0,1))
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$use1 <- factor(dat$use1, levels = c("noauto","auto"))
View(dat)
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$use1 <- factor(dat$use1, labels = c("noauto","auto"))
View(dat)
table(dat$use, dat$use1)
table(dat$use, as.integer(dat$use1))
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
table(dat$use, dat$use1)
dat$use1 <- factor(dat$use1, labels = c("noauto","auto"))
table(dat$use, as.integer(dat$use1))
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
table(dat$use, dat$use1)
fit <- glm(dat$use ~ dat$wind, family = "binomial")
fit1 <- glm(dat$use1 ~ dat$wind, family = "binomial")
fit$coefficients ; fit1$coefficients
exp(fit$coefficients[1]+fit$coefficients[2])
exp(fit1$coefficients[1]+fit1$coefficients[2])
fit2 <- update(fit1, glm(dat$use1 ~ dat$magn, family = "binomial"))
fit3 <- glm(data$use1 ~ dat$wind + dat$magn, family = "binomial")
exp(fit2$coefficients[1]+fit2$coefficients[2])
summary(fit2)
exp(fit2$coefficients[1]+fit2$coefficients[2]+fit2$coefficients[3]+fit2$coefficients[4])
fit2 <- update(fit1, glm(dat$use1 ~ dat$magn -1, family = "binomial"))
summary(fit2)
exp(fit2$coefficients[1]+fit2$coefficients[2]+fit2$coefficients[3]+fit2$coefficients[4])
data("InsectSprays")
str(Inse)
str(InsectSprays)
pfit <- glm(InsectSprays$count ~ InsectSprays$spray, family = "poisson")
summary(pfit)
pfit <- glm(InsectSprays$count ~ InsectSprays$spray - 1, family = "poisson")
summary(pfit)
pfit$coefficients[1,1]
pfit$coefficients[1]
pfit$coefficients[1] - pfit$coefficients[2]
x <- -5:5
y <- c(5.12, 3.93, 2.67, 1.87, 0.52, 0.08, 0.93, 2.05, 2.54, 3.87, 4.97)
plot(x,y)
y.sub <- y[6-11]
y.sub
y.sub <- y[seq(6,11,1)]
y.sub
fit3 <- lm(y ~ x)
fit3$coefficients
x.sub <- x[seq(6,11,1)]
fit3 <- lm(y.sub ~ x.sub)
fit3$coefficients
plot(x.sub, y.xub)
plot(x.sub, y.sub)
plot(x, y)
x.sub
data("shuttle")
str(shuttle)
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
table(dat$use, dat$use1)
fit1 <- glm(dat$use1 ~ dat$wind, family = "binomial")
fit1$coefficients
fit2 <- update(fit1, glm(dat$use1 ~ dat$magn, family = "binomial"))
summary(fit2)
fit1 <- glm(dat$use1 ~ dat$wind, family = "binomial")
fit2 <- update(fit1, glm(dat$use1 ~ dat$magn, family = "binomial"))
summary(fit2)
table(dat$use, dat$use1)
fit1 <- glm(dat$use1 ~ dat$wind, family = "binomial")
fit1$coefficients
#Quiz 2
fit2 <- update(fit1, glm(dat$use1 ~ dat$magn, family = "binomial"))
summary(fit2)
library(MASS)
data("shuttle")
str(shuttle)
dat <- shuttle
dat$use1 <- abs(as.integer(dat$use) - 2)
table(dat$use, dat$use1)
View(dat)
fit1$coefficients
fit1 <- glm(dat$use1 ~ dat$wind, family = "binomial")
fit1$coefficients
fit2 <- glm(dat$use1 ~ dat$wind + dat$magn, family = "binomail")
fit2 <- glm(dat$use1 ~ dat$wind + dat$magn, family = "binomial")
summary(fit2)
View(dat)
table(dat$magn)
fit1$coefficients[2]
exp(fit1$coefficients[2])
summary(fit1)
exp(fit1$coefficients[2])
exp(0.031)
exp(0.1066)
table(dat$wind, as.integer(dat$wind))
1/exp(fit1$coefficients[2])
dat$wind <- abs(as.integer(dat$wind) - 2)
dat <- shuttle
#Transform use auto = 1, no = 2 -> auto = 0, no = 1
dat$use1 <- abs(as.integer(dat$use) - 2)
#check use, use1
table(dat$use, dat$use1)
dat$wind1 <- abs(as.integer(dat$wind) - 2)
table(dat$wind, dat$wind1)
exp(fit1$coefficients[2])
1/exp(fit1$coefficients[2])
table(dat$wind, dat$wind1)
dat$wind1 <- abs(as.integer(dat$wind) - 1)
table(dat$wind, dat$wind1)
dat$wind1 <- abs(as.integer(dat$wind) - 3)
table(dat$wind, dat$wind1)
dat$wind1 <- abs(as.integer(dat$wind) - 1)
table(dat$wind, dat$wind1)
dat$wind1 <- abs(as.integer(dat$wind) - 2) + 1
table(dat$wind, dat$wind1)
dat$wind1 <- (abs(as.integer(dat$wind) - 2) + 1)
table(dat$wind, dat$wind1)
fit1 <- glm(dat$use1 ~ dat$wind1, family = "binomial")
exp(fit1$coefficients[2])
exp(fit1$coefficients[2])
fit2 <- glm(dat$use1 ~ dat$wind1 + dat$magn, family = "binomial")
summary(fit2)
dat$wind1 <- factor((abs(as.integer(dat$wind) - 2) + 1))
#check
table(dat$wind, dat$wind1)
fit1 <- glm(dat$use1 ~ dat$wind1, family = "binomial")
#exp of(B1) is the odd ratio of odd(P when X + 1)/odd(P when X = 1)
exp(fit1$coefficients[2])
#Quiz 2
#fit2 <- update(fit1, glm(dat$use1 ~ dat$magn, family = "binomial"))
fit2 <- glm(dat$use1 ~ dat$wind1 + dat$magn, family = "binomial")
summary(fit2)
View(dat)
dat$wind1 <- factor((abs(as.integer(dat$wind) - 2) + 1), levels = c("head","tail))
)
dat$wind1 <- factor((abs(as.integer(dat$wind) - 2) + 1), levels = c("head","tail"))
#check
table(dat$wind, dat$wind1)
dat$wind1 <- abs(as.integer(dat$wind) - 2) + 1
dat$wind1 <- factor(dat$wind1, labels = c("tail","head"))
table(dat$wind, dat$wind1)
dat <- shuttle
#Transform use auto = 1, no = 2 -> auto = 0, no = 1
dat$use1 <- abs(as.integer(dat$use) - 2)
dat$use1 <- factor(dat$use1, labels = c("noauto","auto"))
#check use, use1
table(dat$use, dat$use1)
#Tranform wind head = 1, tail = 2 -> head = 2, tail = 1
dat$wind1 <- abs(as.integer(dat$wind) - 2) + 1
dat$wind1 <- factor(dat$wind1, labels = c("tail","head"))
#check
table(dat$wind, dat$wind1)
fit1 <- glm(dat$use1 ~ dat$wind1, family = "binomial")
#exp of(B1) is the odd ratio of odd(P when X + 1)/odd(P when X = 1)
exp(fit1$coefficients[2])
#Quiz 2
#fit2 <- update(fit1, glm(dat$use1 ~ dat$magn, family = "binomial"))
fit2 <- glm(dat$use1 ~ dat$wind1 + dat$magn, family = "binomial")
summary(fit2)
summary(fit2)
summary(fit1)
table(dat$wind, dat$wind1)
summary(fit1)
#exp of(B1) is the odd ratio of odd(P when X + 1)/odd(P when X = 1)
exp(fit1$coefficients[2])
fit2 <- glm(dat$use1 ~ dat$wind1 + dat$magn, family = "binomial")
summary(fit2)
View(dat)
exp(fit2$coefficients)
("InsectSprays")
str(InsectSprays)
pfit <- glm(InsectSprays$count ~ InsectSprays$spray - 1, family = "poisson")
summary(pfit)
pfit$coefficients[1] - pfit$coefficients[2]
pfit$coefficients[2] - pfit$coefficients[1]
pfit$coefficients[1]/pfit$coefficients[2]
exp(pfit$coefficients[1]/pfit$coefficients[2])
(InsectSprays)
str(InsectSprays)
InsectSprays
dt <- InsectSprays
table(dt$spray)
as.numeric(dt$spray)
pfit <- glm(dt$count ~ dt$spray, family = "poisson")
summary(pfit)
pfit$coefficients
pfit$coefficients[1]
pfit$coefficients[2]
exp(-pfit$coefficients[2])
data("mtcars")
str(mtcars)
library(ggplot2)
data("mtcars")
str(mtcars)
summary(mtcars)
View(mtcars)
?mtcars
dat <- mtcars
fit <- lm(dat$mpg ~ .)
fit <- lm(mpg ~ . , data = dat)
summary(fit)
library(GGally)
g <- ggpairs(data = mtcars, lower = list(continuous_scale = "smooth"))
g
dat <- mtcars
dat$cyl <- factor(mtcars$cyl)
View(dat)
dat$cyl <- factor(dat$cyl)
dat$cyl <- factor(dat$cyl)
dat$vs <- factor(dat$vs)
dat$am <- factor(dat$am)
dat$gear <- factor(dat$gear)
g2 <- ggpairs(data = dat, lower = list(continuous_scale = "smooth"))
g2
g3 <- ggplot(data = dat, aes(x = am, y = mpg)) +
geom_boxplot()
g3
g3
auto <- dat$am = 0
mpg.auto <- dat$mpg[dat$am = 0,]
mpg.auto <- dat$mpg[dat$am == 0,]
mpg.auto <- dat[dat$am == 0,"mpg"]
mpg.auto
summary(mpg.auto)
summary(mpg.auto)
mpg.man <- dat[dat$am == 1,"mpg"]
summary(mpg.auto, mpg.man)
summary(mpg.man)
var(mpg.man) ; var(mpg.auto)
t.test(mpg.auto, mpg.man, paired = FALSE, var.equal = FALSE)
t.test(mpg.man, mpg.auto, paired = FALSE, var.equal = FALSE)
t.test(mpg.man - mpg.auto, paired = FALSE, var.equal = FALSE)
t.test(I(mpg.man - mpg.auto), paired = FALSE, var.equal = FALSE)
t.test(mpg.man,mpg.auto, paired = FALSE, var.equal = FALSE)
t.test(mpg.man,mpg.auto, paired = FALSE, var.equal = FALSE)
t.test(mpg.man,mpg.auto, paired = FALSE, var.equal = FALSE, alternative = "greater")
data("mtcars")
str(mtcars)
summary(mtcars)
fit <- lm(data = dt, mpg ~ .)
dt <- mtcars
fit <- lm(mpg ~ ., data = dt)
summary(fit)
attributes(fit)
dt2 <- dt
dt2$cyl <- factor(dt$cyl)
dt2$vs <- factor(dt$vs)
dt2$am <- factor(dt$am)
dt2$gear <- factor(dt$gear)
fit2 <- lm(mpg ~ ., data = dt2)
summary(fit2)
fit <- glm(mpg ~ ., data = dt, family = "poisson")
summary(fit)
fit2 <- glm(mpg ~ ., data = dt2, family = "poisson")
summary(fit2)
fit <- lm(mpg ~ ., data = dt)
summary(fit)
fit2 <- lm(mpg ~ ., data = dt2)
summary(fit2)
dt <- mtcars
fit <- lm(mpg ~ am, data = dt)
summary(fit)
fit2 <- lm(mpg ~ factor(am), data = dt)
summary(fit2)
library(ggplot2)
g <- ggplot(data = dt, aes(x = am, y = mpg)) +
geom_point()
g
g <- ggplot(data = dt, aes(x = am, y = mpg)) +
geom_boxplot()
g
g <- ggplot(data = dt, aes(x = am, y = mpg)) +
geom_boxplot(aes(x = am))
g
g <- ggplot(data = dt, aes(x = am, y = mpg)) +
geom_boxplot(data = dt)
g
g <- ggplot(data = dt) +
geom_boxplot(aes(x = am, y = mpg))
g
g <- ggplot(data = dt2) +
geom_boxplot(aes(x = am, y = mpg))
g
resid(fit1)
fit1 <- lm(mpg ~ factor(am), data = dt)
summary(fit1)
resid(fit1)
plot(x = am, y = resid(fit1))
plot(x = dt$am, y = resid(fit1))
boxplot(x = dt$am, y = resid(fit1))
boxplot(x = factor(dt$am), y = resid(fit1))
plot(x = dt$am, y = resid(fit1))
hist(resid(fit1))
summary(fit1)
g <- ggplot(data = dt) +
geom_boxplot(aes(x = factor(am), y = resid(fit1)))
g
fit3  <- lm(mpg ~ ., data = dt)
install.packages(car)
install.packages("car")
library(car)
library(car)
fit3  <- lm(mpg ~ ., data = dt)
vif(fit3)
fit2 <- lm(mpg ~ ., data = dt)
vif(fit3)
dt2 <- dt
dt2$cyl <- factor(dt$cyl)
dt2$vs <- factor(dt$vs)
dt2$am <- factor(dt$am)
dt2$gear <- factor(dt$gear)
fit3 <- lm(mpg ~ ., data = dt2)
vif(fit3)
vif(fit2)
dt2 <- dt
dt2$cyl <- factor(dt$cyl)
dt2$vs <- factor(dt$vs)
dt2$am <- factor(dt$am)
dt2$gear <- factor(dt$gear)
fit3 <- lm(mpg ~ ., data = dt2)
vif(fit3)
fit1 <- lm(mpg ~ factor(am), data = dt)
summary(fit1)
fit2 <- lm(mpg ~ ., data = dt)
vif(fit2)
View(dt)
fit1 <- lm(mpg ~ am, data = dt)
summary(fit1)
source('~/Documents/R Project/Linear Regression Mode/Regression Model - Final Project.R')
source('~/Documents/R Project/Linear Regression Mode/Regression Model - Final Project.R')
source('~/Documents/R Project/Linear Regression Mode/Regression Model - Final Project.R')
fit1.1 <- update(fit1, mpg ~ am + disp)
fit1 <- lm(mpg ~ am, data = dt)
dt <- mtcars
#Test single-regression
fit1 <- lm(mpg ~ am, data = dt)
summary(fit1)
fit1.1 <- update(fit1, mpg ~ am + disp)
fit1.2 <- update(fit1, mpg ~ am + disp + cyl)
fit1.3 <- update(fit1, mpg ~ am + disp + cyl + wt)
anova(fit1, fit1.1, fit1.2, fit1.3)
vit(fit1.3)
vif(fit1.3)
library(car)
fit2 <- lm(mpg ~ ., data = dt)
vif(fit2)
library(car)
fit2 <- lm(mpg ~ ., data = dt)
vif(fit2)
fit1.1 <- update(fit1, mpg ~ drat)
fit1.2 <- update(fit1, mpg ~ dart + vs)
fit1.2 <- update(fit1, mpg ~ dart + vs + gear)
fit1.1 <- update(fit1, mpg ~ drat)
fit1.2 <- update(fit1, mpg ~ dart + vs)
fit1.3 <- update(fit1, mpg ~ dart + vs + gear)
anova(fit1, fit1.1, fit1.2, fit1.3)
fit1.1 <- update(fit1, mpg ~ drat)
fit1.2 <- update(fit1, mpg ~ dart + vs)
fit1.3 <- update(fit1, mpg ~ dart + vs + gear)
anova(fit1, fit1.1, fit1.2, fit1.3)
fit1.1 <- update(fit1, mpg ~ am + drat)
fit1.2 <- update(fit1, mpg ~ am + dart + vs)
fit1.3 <- update(fit1, mpg ~ am + dart + vs + gear)
anova(fit1, fit1.1, fit1.2, fit1.3)
vif(fit1.3)
dt <- mtcars
#Test single-regression
fit1 <- lm(mpg ~ am, data = dt)
fit1.1 <- update(fit1, mpg ~ am + drat)
fit1.2 <- update(fit1, mpg ~ am + dart + vs)
fit1.2 <- update(fit1, mpg ~ am + drat + vs)
fit1.3 <- update(fit1, mpg ~ am + drat + vs + gear)
anova(fit1, fit1.1, fit1.2, fit1.3)
vif(fit1.3)
vif(fit1.2)
library(ggplot2)
data("mtcars")
dt <- mtcars
#Test single-regression
fit1 <- lm(mpg ~ am, data = dt)
summary(fit1)
summary(fit1)$coefficent
fit1$coefficients
summary(fit1)$coefficients
g <- ggplot(data = mtcars) +
geom_boxplot(aes(x = am, y = mpg))
g
g <- ggplot(data = mtcars) +
geom_boxplot(aes(x = factor(am), y = mpg))
g
o=FALSE}
g <- ggplot(data = mtcars) +
geom_boxplot(aes(x = factor(am), y = resid(fit1)))
g
library(car)
fit2 <- lm(mpg ~ ., data = dt)
library(ggplot2)
data("mtcars")
dt <- mtcars
fit1 <- lm(mpg ~ am, data = dt)
fit2 <- lm(mpg ~ ., data = dt)
vif(fit2)
fit1.1 <- update(fit1, mpg ~ am + drat)
fit1.2 <- update(fit1, mpg ~ am + drat + vs)
fit1.3 <- update(fit1, mpg ~ am + drat + vs + gear)
anova(fit1, fit1.1, fit1.2, fit1.3)
h <- ggplot(data = mtcars) +
geom_point(resid(fit1.2))
h
h <- ggplot(data = mtcars) +
geom_point(aes(resid(fit1.2)))
h
h <- ggplot(data = mtcars) +
geom_histogram(y = resid(fit1.2))
h
i <- ggplot(data = mtcars) +
geom_histogram(y = resid(fit1.2))
i
resit(fit1.2)
resid(fit1.2)
i <- ggplot(data = mtcars) +
geom_hist(aes(resid(fit1.2)))
i
i <- ggplot(data = mtcars) +
geom_histogram(aes(resid(fit1.2)))
i
library(ggplot2)
data("mtcars")
str(mtcars)
summary(mtcars)
test <- t.test(mpg ~ am)
test <- t.test(mpg ~ am, data = mtcars)
summary(test)
test
test$estimate
test$estimate[1]
test$estimate[1]-test$estimate[2]
model <- step(lm(mpg ~ . ,data = mtcars), k=log(nrow(mtcars)))
summary(model)
library(car)
vif(model)
